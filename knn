#!/usr/bin/env python

from model import Model
from os import PathLike
from typing import Callable
from pprint import pprint
import csv

def load_csv(parse: Callable[[list[str]], list[any]], path: PathLike = "dataset/iris.csv"):
    dataset = []

    with open(path, "r", encoding="utf-8") as f:
        reader = csv.reader(f)

        for row in reader:
            dataset.append(row)
    
    dataset.pop(0)
    return [parse(data) for data in dataset]

if __name__ == "__main__":
    dataset = load_csv(lambda data: [float(data[0]), float(data[1]), float(data[2]), float(data[3]), data[4]])

    model = Model()
    model.fit([data[:-1] for data in dataset], [data[-1] for data in dataset])
    model.classify()
