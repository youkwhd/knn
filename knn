#!/usr/bin/env python

from model import Model
from pprint import pprint
import dataset

if __name__ == "__main__":
    dt = dataset.load(lambda data: [float(data[0]), float(data[1]), float(data[2]), float(data[3]), data[4]])
    dt = dataset.split(dt, n=3*4)

    model = Model()
    model.fit([data[:-1] for data in dt["train"]], [data[-1] for data in dt["train"]])

    error = 0
    for data in dt["test"]:
        predicted = model.classify(data[:-1])
        actual = data[-1]
        error += predicted != actual
    
    print(f"Error Rate: {100 / (len(dt["test"]) / error)}%")
